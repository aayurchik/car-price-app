# Car Price Prediction App 

Streamlit-приложение для прогнозирования цены автомобиля.

- EDA визуализации
- Загрузка CSV или ручной ввод данных
- Прогноз цены с помощью Ridge Regression
- Визуализация коэффициентов модели

## Запуск 
```bash
https://car-price-app-yytjymldmgarqg4aa3s2mz.streamlit.app/

streamlit run app.py
```

# Отчет по анализу и моделированию цен автомобилей  
  
## 1. Что было сделано  (в оформлении помог ИИ)
   - Загружены тренировочный и тестовый датасеты.  
   - Проверены пропуски и дубликаты.  
   - Числовые признаки приведены к типу `float` или `int`. 
   - Пропуски заполнены медианой, `torque` и `name` удалён.  
   - Дубликаты строк удалены, оставлены первые записи.  
   - Исследованы распределения числовых и категориальных признаков.  
   - Оценены возможные зависимости признаков с целевой переменной `selling_price`.  
   - Выявлены корреляции между признаками.  
   - Линейная регрессия (на числовых признаках, с логарифмированием целевой переменной). Цену логарифмировали.  
   - Стандартизация признаков.  
   - Регуляризация: Lasso, ElasticNet.  
   - Ridge-регрессия на закодированных категориальных признаках (One-Hot Encoding).  
   - GridSearchCV для Lasso и ElasticNet с кросс-валидацией (10 фолдов).  
   - GridSearchCV для Ridge с подбором α.  
   - Бизнес-метрика: доля прогнозов, отличающихся от реальных цен не более чем на 10%.  
  
### 2.1 Метрики качества моделей  

| Модель                        | R²_train | R²_test | MSE_train | MSE_test | Бизнес-метрика |
|--------------------------------|----------|---------|-----------|----------|----------------|
| Linear (без лог)               | 0.592    | 0.594   | 116873067751.522     | 233297548204.611    | 0.227          |
| Linear (log)                   | 0.824    | 0.859   | 0.103     | 0.101    | 0.294          |
| Linear + StandardScaler (log)  | 0.824    | 0.859   | 0.103     | 0.101    | 0.294          |
| Lasso (α=0.01, log)           | 0.822   | 0.857   | 0.104     | 0.103    | 0.280          |
| Ridge + OHE (log)             | 0.878    | 0.891   | 0.071     | 0.078    | 0.360          |

**Интерпретация:**  
- Логарифмирование целевой переменной существенно улучшило устойчивость модели.  
- Стандартизация признаков на логарифмированной цене не изменяет результат.  
- Регуляризация с малым α не зануляет коэффициенты, так как все признаки информативны.  
- Наибольшую точность и бизнес-метрику показала Ridge-регрессия на OHE признаках.  

### 2.2 Важность признаков  
- Наиболее информативный признак: **year**.  
- Значительный вклад в прогноз вносят: `engine`, `max_power`, `mileage`.  
- Остальные признаки менее важны, но также учитываются моделью.  

## 3. Что дало наибольший прирост качества  
1. Логарифмирование целевой переменной  
2. One-Hot Encoding категориальных признаков и использование Ridge-регрессии  
---

## 4. Что сделать не удалось и почему
- Зануление коэффициентов при Lasso не произошло из-за малого α.  
- Избавились от некоторых столбцов, слишком долго обрабатывать.  
- Используем только линейные модели, что не всегда адекватно отражает нелинейные зависимости.

## 5. Оценка разработанного сервиса  

### 5.1 Удобство использования
- Есть вкладки с разной информацией.  
- Есть ручной ввод и загрузка csv.  
- ДОбавлены описания переменных на странице с коэф.модели.  

### 5.2 Визуализация  
- Тепловая карта корреляций, распределение цены, описательные статистики.  
- Немного кривой масштаб на боксплотах, плохо помещаются назваиня категорий.  

### 5.3 Ограничения и проблемы
- OHE создаёт большое число новых столбцов. Не особо удобно использовать seats как категориальную (было по заданию, зачем?)  
- Кажется у меня в приложении модель в прогнозе плохо реагирует на категориальные переменные, что-то кривое, не вижу изменений в цифрах.
- Линейные модели чувствительны к выбросам без логарифмирования. Сложные нелинейные зависимости не полностью учитываются.  

### 5.4 Планируемые улучшения  
- Применить методы отбора признаков для уменьшения размерности после OHE.  
- Вникнуть в отображение категориальных переменных в приложении, плохо обрабатываются. Но для ручного ввода не удобно передавать все переменные, которые были кодированы и не должны подаваться одновременно с 1. Нужно придумать, как это предложить пользователю, чтобы он не сделал лишнего и было легко понятно. 

## **Вывод**  
Наиболее успешной моделью с точки зрения метрик качества и бизнес-метрики является **Ridge-регрессия на стандартизированных признаках с OHE категориальных переменных и логарифмированной целевой переменной**.   







